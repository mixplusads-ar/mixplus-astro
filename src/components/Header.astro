---
import { categories } from '../data/categories';
const { lang = 'fa' } = Astro.props;
const isFa = lang === 'fa';
const t = (fa, en)=> isFa ? fa : en;
---
<header class="header fixed top-0 inset-x-0 z-50 transition-all">
  <div class="relative mx-auto max-w-[1280px] px-6 py-3 flex items-center gap-6 justify-between">
   <a href={isFa?'/fa/':'/en/'} class="flex items-center gap-3">
  <!-- Light theme -->
  <img src="/img/logo.svg" alt="MixPlus" width="64" height="64"
       class="w-16 h-16 block dark:hidden" loading="eager" decoding="async" />
  <!-- Dark theme -->
  <img src="/img/logo-dark.svg" alt="MixPlus" width="64" height="64"
       class="w-16 h-16 hidden dark:block" loading="eager" decoding="async" />
</a>
    <nav class="hidden md:flex items-center gap-5" role="navigation" aria-label="main">
  <div class="group relative">
    <button class="btn btn-outline">
      {t('محصولات','Products')}
      <svg width="14" height="14" viewBox="0 0 24 24">
        <path fill="currentColor" d="M7 10l5 5 5-5z" />
      </svg>
    </button>

    <div class={`pointer-events-none absolute mt-3 ${isFa ? 'right-6' : 'left-6'}`}>
      <div
        class="pointer-events-auto opacity-0 translate-y-1 group-hover:opacity-100 group-hover:translate-y-0 transition
               w-[920px] max-w-[90vw] rounded-2xl glass p-6 shadow-soft border"
        style="border-color:var(--stroke)"
      >
        <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
          {categories.map((cat) => (
            <div>
              <a
                href={`/${lang}/products/${cat.slug}`}
                class="mb-2 flex items-center justify-between font-medium hover:text-brand"
                class:list={[isFa ? 'font-fa' : 'font-en']}
              >
                <span>{isFa ? cat.nameFa : cat.nameEn}</span>
                <svg width="16" height="16" viewBox="0 0 24 24">
                  <path fill="currentColor" d="M9 6l6 6-6 6" />
                </svg>
              </a>

              {cat.subs && (
                <ul class="space-y-1 text-sm text-[var(--fg-muted)]">
                  {cat.subs.map((s) => (
                    <li>
                      <a
                        href={`/${lang}/products/${cat.slug}/${s.slug}`}
                        class="hover:text-brand"
                      >
                        {isFa ? s.nameFa : s.nameEn}
                      </a>
                    </li>
                  ))}
                </ul>
              )}
            </div>
          ))}
        </div>
      </div>
    </div>
  </div>

  <a href={`/${lang}/about`} class="btn btn-outline">{t('درباره ما','About')}</a>
  <a href={`/${lang}/after-sales`} class="btn btn-outline">{t('خدمات پس از فروش','After-Sales')}</a>
  <a href={`/${lang}/dealers`} class="btn btn-outline">{t('نمایندگی‌ها','Dealers')}</a>
</nav>
    <div class="flex items-center gap-3">
      <a href="/catalog.pdf" class="btn btn-primary">{t('دانلود کاتالوگ','Download Catalog')}</a>
      <button id="themeToggle" class="btn btn-outline" aria-label="theme">
        <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentColor" d="M12 3a9 9 0 1 0 9 9 7 7 0 0 1-9-9z"/></svg>
      </button>
      <a class="btn btn-outline" href={isFa?'/en/':'/fa/'}>{isFa?'EN':'FA'}</a>
    </div>
  </div>
  <script>
    // theme toggle
    document.getElementById('themeToggle').addEventListener('click', ()=>{
      const html = document.documentElement;
      const dark = html.classList.contains('dark');
      html.classList.toggle('dark', !dark);
      html.classList.toggle('light', dark);
      localStorage.setItem('theme', dark? 'light':'dark');
    });
  </script>
</header>
