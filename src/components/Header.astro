---
import { social } from '../../data/social';

const lang = Astro.props.lang ?? 'fa';
const isFa = lang === 'fa';

const faProducts = [
  { label: 'Ø§Ø¬Ø§Ù‚ Ø§Ø³ØªÛŒÙ„', href: '/fa/products/hob/steel' },
  { label: 'Ø§Ø¬Ø§Ù‚ Ø´ÛŒØ´Ù‡â€ŒØ§ÛŒ', href: '/fa/products/hob/glass' },
  { label: 'Ø§Ø¬Ø§Ù‚ Ù„Ø¹Ø§Ø¨ÛŒ', href: '/fa/products/hob/enamel' },
  { label: 'Ø§Ø¬Ø§Ù‚ Ø¨Ø±Ù‚ÛŒ', href: '/fa/products/hob/electric' },
];

const faSinks = [
  { label: 'Ø³ÛŒÙ†Ú©â€ŒÙ‡Ø§ÛŒ Ø¯Ø³Øªâ€ŒØ³Ø§Ø²', href: '/fa/products/sink/handmade' },
  { label: 'Ø§Ø³ØªÛŒÙ„ ØªÙˆÚ©Ø§Ø±', href: '/fa/products/sink/undermount' },
  { label: 'Ù†ÛŒÙ…Ù‡ ÙØ§Ù†ØªØ²ÛŒ', href: '/fa/products/sink/semi-fancy' },
  { label: 'Ú¯Ø±Ø§Ù†ÛŒØªÛŒ', href: '/fa/products/sink/granite' },
  { label: 'Ø²ÛŒØ± Ú©Ø§Ø¨ÛŒÙ†ØªÛŒ', href: '/fa/products/sink/under' },
];

const faHoods = [
  { label: 'Ù‡ÙˆØ¯ ØªÙˆÚ©Ø§Ø±', href: '/fa/products/hood/built-in' },
  { label: 'Ù‡ÙˆØ¯ Ø¯ÛŒÙˆØ§Ø±ÛŒ', href: '/fa/products/hood/wall' },
];

const faAfterSales = [
  { label: 'ÙØ±Ø§ÛŒÙ†Ø¯ Ø±Ø³ÛŒØ¯Ú¯ÛŒ Ø¨Ù‡ Ø´Ú©Ø§ÛŒØ§Øª', href: '/fa/after-sales/complaint-process' },
  { label: 'Ø´Ø±Ø§ÛŒØ· Ú¯Ø§Ø±Ø§Ù†ØªÛŒ Ù…Ø­ØµÙˆÙ„Ø§Øª Ù…ÛŒÚ©Ø³ Ù¾Ù„Ø§Ø³ Ùˆ Ø¨Ø§Ø±ÛŒØ³ØªØ§', href: '/fa/after-sales/warranty-terms' },
  { label: 'Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù†ØµØ¨ Ù…Ø­ØµÙˆÙ„', href: '/fa/after-sales/installation-request' },
  { label: 'Ø´Ú©Ø§ÛŒØª', href: '/fa/after-sales/complaint' },
];

const enAfterSales = [
  { label: 'Complaint Process', href: '/en/after-sales/complaint-process' },
  { label: 'Warranty Terms', href: '/en/after-sales/warranty-terms' },
  { label: 'Installation Request', href: '/en/after-sales/installation-request' },
  { label: 'Complaint', href: '/en/after-sales/complaint' },
];

const enProducts = [
  { label: 'Gas Hobs', href: '/en/products/hob' },
  { label: 'Sinks', href: '/en/products/sink' },
  { label: 'Hoods', href: '/en/products/hood' },
  { label: 'Ovens', href: '/en/products/oven' },
];
---

<header class={`mix-header ${isFa ? 'mix-header--fa' : 'mix-header--en'}`}>
  <div class="mix-header__inner">

    {isFa ? (
      <>
        <!-- Ø±Ø§Ø³Øª: Ù…Ø­ØµÙˆÙ„Ø§Øª / Ù†Ù…Ø§ÛŒÙ†Ø¯Ú¯ÛŒ / Ø®Ø¯Ù…Ø§Øª Ù¾Ø³ Ø§Ø² ÙØ±ÙˆØ´ -->
        <nav class="mix-header__side mix-header__side--primary">
          <!-- Ù…Ø­ØµÙˆÙ„Ø§Øª Ø¨Ø§ Ù…Ú¯Ø§Ù…Ù†Ùˆ -->
          <div class="mix-menu-item mix-menu-item--has-mega">
            <a href="/fa/products" class="mix-link">Ù…Ø­ØµÙˆÙ„Ø§Øª</a>
            <div class="mix-mega mix-mega--products mix-mega--rtl">
              <div class="mix-mega__col">
                <div class="mix-mega__title">Ø§Ø¬Ø§Ù‚ Ú¯Ø§Ø²</div>
                {faProducts.map(item => (
                  <a href={item.href} class="mix-mega__link">{item.label}</a>
                ))}
              </div>
              <div class="mix-mega__col">
                <div class="mix-mega__title">Ø³ÛŒÙ†Ú© Ø¸Ø±ÙØ´ÙˆÛŒÛŒ</div>
                {faSinks.map(item => (
                  <a href={item.href} class="mix-mega__link">{item.label}</a>
                ))}
              </div>
              <div class="mix-mega__col">
                <div class="mix-mega__title">Ù‡ÙˆØ¯</div>
                {faHoods.map(item => (
                  <a href={item.href} class="mix-mega__link">{item.label}</a>
                ))}
              </div>
              <div class="mix-mega__col">
                <div class="mix-mega__title">ÙØ± ØªÙˆÚ©Ø§Ø±</div>
                <a href="/fa/products/oven" class="mix-mega__link">ÙØ± ØªÙˆÚ©Ø§Ø±</a>
              </div>
            </div>
          </div>

          <a href="/fa/dealers" class="mix-link mix-menu-item">Ù†Ù…Ø§ÛŒÙ†Ø¯Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ø¬Ø§Ø²</a>

          <div class="mix-menu-item mix-menu-item--has-mega">
            <a href="/fa/after-sales" class="mix-link">Ø®Ø¯Ù…Ø§Øª Ù¾Ø³ Ø§Ø² ÙØ±ÙˆØ´</a>
            <div class="mix-mega mix-mega--rtl">
              {faAfterSales.map(item => (
                <a href={item.href} class="mix-mega__link mix-mega__link--wide">
                  {item.label}
                </a>
              ))}
            </div>
          </div>
        </nav>

        <!-- Ù„ÙˆÚ¯Ùˆ ÙˆØ³Ø· -->
        <div class="mix-header__logo-wrap">
          <a href="/fa" class="mix-logo-link">
            <img src="/logo-dark.svg" alt="MixPlus" class="mix-logo mix-logo--light" loading="lazy" />
            <img src="/logo.svg" alt="MixPlus" class="mix-logo mix-logo--dark" loading="lazy" />
          </a>
        </div>

        <!-- Ú†Ù¾: Ø³Ø±Ú† / Ù‡Ø´ØªÚ¯ / Ø¯Ø±Ø¨Ø§Ø±Ù‡ / Ø¯Ø§Ù†Ù„ÙˆØ¯ / Ø²Ø¨Ø§Ù† / ØªÙ… -->
        <nav class="mix-header__side mix-header__side--secondary">
          <button class="mix-icon-btn" type="button" aria-label="Search">
            <span class="mix-icon">ğŸ”</span>
          </button>

          <div class="mix-divider" />

          <div class="mix-menu-item mix-menu-item--has-mega">
            <button type="button" class="mix-link mix-link--button">#</button>
            <div class="mix-mega mix-mega--rtl">
              {(Array.isArray(social) ? social : []).map(item => (
                <a href={item.href} target="_blank" rel="noreferrer" class="mix-mega__link">
                  {item.label}
                </a>
              ))}
            </div>
          </div>

          <div class="mix-divider" />

          <a href="/fa/about" class="mix-link mix-menu-item">Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ù…Ø§</a>

          <div class="mix-divider" />

          <a href="/fa/catalog" class="mix-link mix-menu-item">Ø¯Ø§Ù†Ù„ÙˆØ¯ Ú©Ø§ØªØ§Ù„ÙˆÚ¯</a>

          <div class="mix-divider" />

          <div class="mix-menu-item mix-menu-item--has-mega">
            <button type="button" class="mix-link mix-link--button">
              ÙØ§Ø±Ø³ÛŒ â–¾
            </button>
            <div class="mix-mega mix-mega--rtl">
              <a href="/en" class="mix-mega__link">English</a>
            </div>
          </div>

          <div class="mix-divider" />

          <button
            type="button"
            class="mix-icon-btn"
            aria-label="Toggle theme"
            onclick="window.__mixToggleTheme && window.__mixToggleTheme()"
          >
            <span class="mix-icon mix-icon--theme">â˜¾</span>
          </button>
        </nav>
      </>
    ) : (
      <>
        <!-- Ú†Ù¾: Products / Dealers / After-Sales / About-Us -->
        <nav class="mix-header__side mix-header__side--primary mix-header__side--ltr">
          <div class="mix-menu-item mix-menu-item--has-mega">
            <a href="/en/products" class="mix-link">Products</a>
            <div class="mix-mega mix-mega--products mix-mega--ltr">
              {enProducts.map(item => (
                <a href={item.href} class="mix-mega__link mix-mega__link--wide">
                  {item.label}
                </a>
              ))}
            </div>
          </div>

          <a href="/en/dealers" class="mix-link mix-menu-item">Dealers</a>

          <div class="mix-menu-item mix-menu-item--has-mega">
            <a href="/en/after-sales" class="mix-link">After-Sales</a>
            <div class="mix-mega mix-mega--ltr">
              {enAfterSales.map(item => (
                <a href={item.href} class="mix-mega__link mix-mega__link--wide">
                  {item.label}
                </a>
              ))}
            </div>
          </div>

          <a href="/en/about" class="mix-link mix-menu-item">About-Us</a>
        </nav>

        <!-- logo center -->
        <div class="mix-header__logo-wrap">
          <a href="/en" class="mix-logo-link">
            <img src="/logo-dark.svg" alt="MixPlus" class="mix-logo mix-logo--light" loading="lazy" />
            <img src="/logo.svg" alt="MixPlus" class="mix-logo mix-logo--dark" loading="lazy" />
          </a>
        </div>

        <!-- Ø±Ø§Ø³Øª: search / # / download / language / theme -->
        <nav class="mix-header__side mix-header__side--secondary mix-header__side--ltr">
          <button class="mix-icon-btn" type="button" aria-label="Search">
            <span class="mix-icon">ğŸ”</span>
          </button>

          <div class="mix-divider" />

          <div class="mix-menu-item mix-menu-item--has-mega">
            <button type="button" class="mix-link mix-link--button">#</button>
            <div class="mix-mega mix-mega--ltr">
              {(Array.isArray(social) ? social : []).map(item => (
                <a href={item.href} target="_blank" rel="noreferrer" class="mix-mega__link">
                  {item.label}
                </a>
              ))}
            </div>
          </div>

          <div class="mix-divider" />

          <a href="/en/catalog" class="mix-link mix-menu-item">Download Catalog</a>

          <div class="mix-divider" />

          <div class="mix-menu-item mix-menu-item--has-mega">
            <button type="button" class="mix-link mix-link--button">
              English â–¾
            </button>
            <div class="mix-mega mix-mega--ltr">
              <a href="/fa" class="mix-mega__link">ÙØ§Ø±Ø³ÛŒ</a>
            </div>
          </div>

          <div class="mix-divider" />

          <button
            type="button"
            class="mix-icon-btn"
            aria-label="Toggle theme"
            onclick="window.__mixToggleTheme && window.__mixToggleTheme()"
          >
            <span class="mix-icon mix-icon--theme">â˜¾</span>
          </button>
        </nav>
      </>
    )}
  </div>
</header>

<script is:inline>
  (() => {
    const apply = (mode) => {
      const body = document.body;
      body.classList.remove('light', 'dark');
      body.classList.add(mode);
      localStorage.setItem('mix-theme', mode);
    };

    let initial = localStorage.getItem('mix-theme');
    if (!initial) {
      initial = window.matchMedia &&
        window.matchMedia('(prefers-color-scheme: dark)').matches
        ? 'dark'
        : 'light';
    }
    apply(initial);

    window.__mixToggleTheme = () => {
      const next = document.body.classList.contains('dark') ? 'light' : 'dark';
      apply(next);
    };
  })();
</script>

<style>
  header.mix-header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: 80px;
    z-index: 1000;
    backdrop-filter: blur(14px);
    -webkit-backdrop-filter: blur(14px);
    background: rgba(0,0,0,0.0);
    border-bottom: 1px solid rgba(255,255,255,0.04);
  }

  .mix-header__inner {
    max-width: 1440px;
    margin: 0 auto;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: space-between;
    position: relative;
    padding: 0 32px;
    box-sizing: border-box;
  }

  .mix-header__side {
    display: flex;
    align-items: center;
    gap: 22px;
  }

  .mix-header__side--primary {
    flex: 1 1 0;
  }

  .mix-header__side--secondary {
    flex: 1 1 0;
    justify-content: flex-end;
  }

  .mix-header__logo-wrap {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    align-items: center;
  }

  .mix-logo-link {
    display: inline-flex;
    align-items: center;
  }

  .mix-logo {
    height: 40px;
    display: block;
  }

  .mix-logo--dark {
    display: none;
  }

  body.light .mix-logo--light {
    display: none;
  }
  body.light .mix-logo--dark {
    display: block;
  }

  .mix-link {
    font-size: 16px;
    text-decoration: none;
    color: inherit;
    cursor: pointer;
    white-space: nowrap;
    transition: color .2s ease;
  }

  .mix-link--button {
    background: none;
    border: none;
    padding: 0;
  }

  .mix-link:hover {
    color: #0fa99c;
  }

  .mix-menu-item {
    position: relative;
    display: flex;
    align-items: center;
  }

  .mix-menu-item--has-mega:hover > .mix-mega {
    opacity: 1;
    pointer-events: auto;
    transform: translateY(0);
  }

  .mix-mega {
    position: absolute;
    top: 56px;
    background: rgba(0,0,0,0.9);
    color: #fff;
    border-radius: 14px;
    padding: 18px 24px;
    min-width: 220px;
    display: flex;
    flex-direction: column;
    gap: 6px;
    box-shadow: 0 18px 50px rgba(0,0,0,0.35);
    opacity: 0;
    pointer-events: none;
    transform: translateY(8px);
    transition: opacity .18s ease, transform .18s ease;
    z-index: 999;
  }

  .mix-mega--products {
    flex-direction: row;
    gap: 32px;
    min-width: 520px;
  }

  .mix-mega__col {
    display: flex;
    flex-direction: column;
    gap: 6px;
    min-width: 120px;
  }

  .mix-mega__title {
    font-weight: 700;
    margin-bottom: 6px;
    font-size: 14px;
    color: #0fa99c;
  }

  .mix-mega__link {
    font-size: 14px;
    text-decoration: none;
    color: #ffffff;
    white-space: nowrap;
    padding: 3px 0;
  }

  .mix-mega__link--wide {
    min-width: 220px;
  }

  .mix-mega__link:hover {
    color: #0fa99c;
  }

  .mix-mega--rtl {
    right: 0;
    text-align: right;
  }

  .mix-mega--ltr {
    left: 0;
    text-align: left;
  }

  .mix-icon-btn {
    border: none;
    background: none;
    padding: 0;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    justify-content: center;
  }

  .mix-icon {
    font-size: 18px;
  }

  .mix-icon--theme {
    font-size: 18px;
  }

  .mix-divider {
    width: 1px;
    height: 18px;
    background: rgba(255,255,255,0.35);
  }

  body.light .mix-divider {
    background: rgba(0,0,0,0.35);
  }

  /* Ø±Ù†Ú¯ Ù…ØªÙ† Ø¯Ø± ØªÙ…â€ŒÙ‡Ø§ */
  body.dark .mix-header,
  body.dark .mix-header * {
    color: #ffffff;
  }

  body.light .mix-header,
  body.light .mix-header * {
    color: #000000;
  }

  /* Ø¢ÛŒÚ©ÙˆÙ†â€ŒÙ‡Ø§ Ø¯Ø± ØªÙ… Ø¯Ø§Ø±Ú© */
  body.dark .mix-icon {
    color: #ffffff;
  }
  body.light .mix-icon {
    color: #000000;
  }

  /* Ú©Ù„ Ø¨Ø¯Ù†Ù‡ Ø¨Ø±Ø§ÛŒ ØªÙ… */
  body.dark {
    background: #050608;
    color: #ffffff;
  }

  body.light {
    background: #f5f5f5;
    color: #000000;
  }

  /* ÙØ§ØµÙ„Ù‡ Ù…Ø­ØªÙˆØ§ Ø§Ø² Ø²ÛŒØ± Ù‡Ø¯Ø± â€“ Ø§Ú¯Ø± Ù„Ø§Ø²Ù… Ø´Ø¯ Ø±ÙˆÛŒ Ù„Ø§ÛŒÙ‡â€ŒÛŒ Ø§ØµÙ„ÛŒ Ú©Ù„Ø§Ø³ main-wrapper Ø§Ø¶Ø§ÙÙ‡ Ú©Ù† */
  :global(.main-wrapper) {
    padding-top: 80px;
  }

  /* RTL / LTR  */
  .mix-header--fa .mix-header__inner {
    direction: rtl;
  }

  .mix-header--en .mix-header__inner {
    direction: ltr;
  }

  .mix-header__side--ltr {
    direction: ltr;
  }
</style>
