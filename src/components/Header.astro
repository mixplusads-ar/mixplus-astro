---
import { categories } from '../data/categories';
const { lang = 'fa' } = Astro.props;
const isFa = lang === 'fa';
const t = (fa, en)=> isFa ? fa : en;
---
<header class="header fixed top-0 inset-x-0 z-50 transition-all">
  <div class="mx-auto max-w-[1280px] px-6 py-3 flex items-center gap-6 justify-between">
    <a href={isFa?'/fa/':'/en/'} class="flex items-center gap-3">
      <div class="w-8 h-8 rounded-lg bg-brand"></div>
      <span class="font-semibold tracking-wide" class:list={[isFa?'font-fa':'font-en']}>MixPlus</span>
    </a>
    <nav class="hidden md:flex items-center gap-5" role="navigation" aria-label="main">
      <div class="group relative">
        <button class="btn btn-outline">
          {t('محصولات','Products')}
          <svg width="14" height="14" viewBox="0 0 24 24"><path fill="currentColor" d="M7 10l5 5 5-5z"/></svg>
        </button>
        <div class="absolute mt-3 hidden group-hover:block left-0 right-0">
          <div class="glass rounded-2xl p-6 shadow-soft border" style="border-color:var(--stroke)">
            <div class="grid grid-cols-4 gap-6">
              {categories.map(cat => (
                <div>
                  <div class="mb-2 font-medium" class:list={[isFa?'font-fa':'font-en']}>{isFa?cat.nameFa:cat.nameEn}</div>
                  <ul class="space-y-1 text-sm text-[var(--fg-muted)]">
                    {cat.subs?.map(s => (
                      <li>
                        <a href={`/${lang}/products/${cat.slug}/${s.slug}`} class="hover:text-brand">{isFa?s.nameFa:s.nameEn}</a>
                      </li>
                    ))}
                  </ul>
                </div>
              ))}
            </div>
          </div>
        </div>
      </div>
      <a href={`/${lang}/about`} class="btn btn-outline">{t('درباره ما','About')}</a>
      <a href={`/${lang}/after-sales`} class="btn btn-outline">{t('خدمات پس از فروش','After‑Sales')}</a>
      <a href={`/${lang}/dealers`} class="btn btn-outline">{t('نمایندگی‌ها','Dealers')}</a>
    </nav>
    <div class="flex items-center gap-3">
      <a href="/catalog.pdf" class="btn btn-primary">{t('دانلود کاتالوگ','Download Catalog')}</a>
      <button id="themeToggle" class="btn btn-outline" aria-label="theme">
        <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentColor" d="M12 3a9 9 0 1 0 9 9 7 7 0 0 1-9-9z"/></svg>
      </button>
      <a class="btn btn-outline" href={isFa?'/en/':'/fa/'}>{isFa?'EN':'FA'}</a>
    </div>
  </div>
  <script>
    // theme toggle
    document.getElementById('themeToggle').addEventListener('click', ()=>{
      const html = document.documentElement;
      const dark = html.classList.contains('dark');
      html.classList.toggle('dark', !dark);
      html.classList.toggle('light', dark);
      localStorage.setItem('theme', dark? 'light':'dark');
    });
  </script>
</header>
